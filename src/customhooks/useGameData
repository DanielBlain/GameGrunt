import { useState, useEffect, createContext } from 'react'
import { useNavigate } from 'react-router-dom'

/*****
 * 
 * GameData CUSTOM HOOK - a hook that unifies the URL path with the current game data
 * 
 * Requires a gameList array, filled with entries of the following form:
 * {key, title, style, expansions[]}
 * 
 * */
export function useGameData(gameList, path) {
    const [currGameInfo, setCurrGameInfo] = useState(null)
    const navigate = useNavigate();

    useEffect(() => {
        function setNewPath(newPath) {
            let newGameKey =
                // Obtain an array containing only gamekeys for all entries in gameList
                gameList.map((gameInfo) => newPath
                    // Iterate over the array of only gamekeys
                    .find(
                        // Find a gamekey that exists somewhere in the pathname
                        ((gameKey) => newPath.includes(gameKey))
                ))
    
            if (newGameKey) {
                setCurrGameInfo(newGameKey)
            }
            else {
                navigate('/notfound')
            }
        }

        setNewPath(path)
    }, [navigate, gameList, path])

    return [currGameInfo]
}