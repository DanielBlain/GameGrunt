import { useState, useEffect } from 'react'
import { useNavigate } from 'react-router-dom'

/*****
 * 
 * useSelectFromPath
 * 
 * If the browser is navigated to a URL (defined in path) containing the corresponding 
 * unique key of an object in the objectList, that object becomes the currObject
 * 
 * Requires an array of object with a unique "key" field, and a path to search
 * 
 * */
export function useSelectFromPath(objectList, path) {
    const [currObject, setCurrObject] = useState(null)
    const navigate = useNavigate()

    useEffect(() => {
        let newObject =
            // Obtain the gameRecord whose key is included in currPath
            path && objectList.find((gameRecord) => path.includes(gameRecord.key))

        if (newObject) {
            setCurrObject(newObject)
        }
        else {
            navigate('/')
        }
    }, [navigate, objectList, path, currObject])

    return currObject
}